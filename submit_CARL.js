function Calculate(){var a=document.getElementById("InsertRecordFilter").checked,b=document.getElementById("InsertRecordEquipment_Cost_and_Instal").value,c=document.getElementById("InsertRecordInfo_System").value,d=document.getElementById("InsertRecordFacility_Improvement").value,e=document.getElementById("InsertRecordSales_Tax").value,f=Number(b)+Number(c)+Number(d)+Number(e);document.getElementById("InsertRecordTotal_Cost").value=f;var g=document.getElementById("InsertRecordCER_Type").value,h=document.getElementsByName("cbParamVirtual7")[0].value,i=document.getElementsByName("cbParamVirtual4")[0].value,j=document.getElementsByName("cbParamVirtual11")[0].value,k=document.getElementsByName("cbParamVirtual8")[0].value,l=document.getElementById("InsertRecordNPV").value,m=document.getElementById("InsertRecordPayback_Period").value,n=document.getElementById("InsertRecordFinancial_Analysis").value,o=document.getElementById("InsertRecordDate").value,p=document.getElementById("InsertRecordContact_Person").value,q=document.getElementById("InsertRecordRequestor_Email").value,r=document.getElementById("InsertRecordPhone").value,s=document.getElementById("InsertRecordAddress").value,t=document.getElementById("InsertRecordRoom_Num").value,u=document.getElementById("InsertRecordComment_Justify").innerHTML,v=document.getElementById("InsertRecordVendor").value,w=document.getElementById("InsertRecordDescription").innerHTML,x=document.getElementById("InsertRecordMD_Buyilne").value,y=document.getElementById("InsertRecordComputer").checked,z=0,A=document.getElementsByName("InsertRecordFacility")[0].value,B=document.getElementsByName("InsertRecordOp_Unit")[0].value,C=document.getElementsByName("cbParamVirtual12")[0].value,D=document.getElementsByName("cbParamVirtual14")[0].value,E=document.getElementsByName("cbParamVirtual15")[0].value,F=document.getElementsByName("cbParamVirtual16")[0].value;a||""!=o&&""!=p&&""!=q&&""!=r&&""!=s&&""!=t?document.getElementById("sec1").style.display="none":document.getElementById("sec1").style.display="block",!a&&(""==w||""==v)||!a&&f>1e4&&""==x?document.getElementById("sec2").style.display="block":document.getElementById("sec2").style.display="none",a||""!=u?document.getElementById("sec3").style.display="none":document.getElementById("sec3").style.display="block",!a&&f>=5e4&&f<=Number(h)&&"Incremental"==g&&(""==l||""==m||""==n)?document.getElementById("sec4").style.display="block":document.getElementById("sec4").style.display="none",!a&&!y&&f<2e3?document.getElementById("computer").style.display="block":document.getElementById("computer").style.display="none",z=a||""!=o&&""!=p&&""!=q&&""!=r&&""!=s&&""!=t?!a&&(""==w||""==v)||!a&&f>1e4&&""==x?1:a||""!=u?!a&&f>=5e4&&f<=Number(h)&&"Incremental"==g&&(""==l||""==m||""==n)?1:!a&&!y&&f<2e3?1:0:1:1,document.getElementById("Submit").onclick=function(b){!a&&0==z&&"Incremental"==g&&Number(h)>=Number(f)&&(document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordIncr_CER").value=Number(i)+Number(f),document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordIncr_Remain").value=Number(h)-Number(f),document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordNonIncr_CER").value=Number(k),document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordNonIncr_Remain").value=Number(j),window.scrollTo(0,0),document.getElementById("loadCover").style.display="block",b.preventDefault(),setTimeout(iframeLoad,3e3)),!a&&0==z&&("Replacement"==g||"Regulation"==g||"Renovation"==g)&&Number(j)>=Number(f)&&(document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordNonIncr_CER").value=Number(k)+Number(f),document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordNonIncr_Remain").value=Number(j)-Number(f),document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordIncr_CER").value=Number(i),document.getElementById("updateBudget").contentWindow.document.getElementById("EditRecordIncr_Remain").value=Number(h),window.scrollTo(0,0),document.getElementById("loadCover").style.display="block",b.preventDefault(),setTimeout(iframeLoad,3e3))},!a&&"Incremental"==g&&Number(h)<Number(f)?(disableSubmit(),alert("Insufficient Incremental Budget!\n\nMax Available: $"+Number(h).toLocaleString()+"\n\nPlease request transfer.")):!a&&("Replacement"==g||"Regulation"==g||"Renovation"==g)&&Number(j)<Number(f)?(disableSubmit(),alert("Insufficient Non-Incremental Budget!\n\nMax Available: $"+Number(j).toLocaleString()+"\n\nPlease request transfer.")):a||1!=z?enableSubmit():disableSubmit(),a&&(document.getElementById("Submit").style.backgroundColor="green",document.getElementById("Submit").value="Save"),(f>=2e3||y)&&"50000 TEC Shared Services"==B&&(document.getElementById("InsertRecordDept_Manager_Email").value=C,document.getElementById("InsertRecordDept_Manager_Name").value=D),(f>=2e3||y)&&"50000 TEC Shared Services"!=B&&Number(A)>800&&(document.getElementById("InsertRecordDept_Manager_Email").value=E,document.getElementById("InsertRecordDept_Manager_Name").value=F),Number(A)>=800||f<2e3&&!y?(document.getElementById("InsertRecordDept_Manager_Email").readOnly=!0,document.getElementById("InsertRecordDept_Manager_Name").readOnly=!0):(document.getElementById("InsertRecordDept_Manager_Email").readOnly=!1,document.getElementById("InsertRecordDept_Manager_Name").readOnly=!1),f<2e3&&!y&&(document.getElementById("InsertRecordDept_Manager_Email").value="",document.getElementById("InsertRecordDept_Manager_Name").value="")}function iframeLoad(){document.getElementById("updateBudget").contentWindow.document.getElementById("Mod0EditRecord").click(),document.getElementById("updateBudget").onload=function(){"Good"==document.getElementById("updateBudget").contentWindow.document.getElementById("loadComplete").value&&setTimeout(function(){document.getElementById("caspioform").submit()},3e3)}}function disableSubmit(){document.getElementById("Submit").disabled=!0,document.getElementById("Submit").style.backgroundColor="red",document.getElementById("Submit").value="Submit â›”"}function enableSubmit(){document.getElementById("Submit").disabled=!1,document.getElementById("Submit").style.backgroundColor="#1959C3",document.getElementById("Submit").value="Submit"}document.getElementById("InsertRecordCER_Num").readOnly=!0,document.getElementsByName("cbParamVirtual1")[0].onchange=function(){var a=document.getElementsByName("cbParamVirtual1")[0].options[0].value;if(1==a){var b=document.getElementById("InsertRecordYear").value,c=document.getElementsByName("InsertRecordFacility")[0].value,d=b+c+"000";document.getElementById("InsertRecordCER_Num").value=d}else document.getElementById("InsertRecordCER_Num").value=Number(a)+1,document.getElementById("InsertRecordCER_Num").value;var e="https://b6.caspio.com/dp.asp?AppKey=91cc200022b59b6df8404790b49f&Cost_Center="+document.getElementsByName("InsertRecordCost_Center")[0].value;document.getElementById("updateBudget").src=e},document.getElementById("InsertRecordEquipment_Cost_and_Instal").addEventListener("input",Calculate),document.getElementById("InsertRecordInfo_System").addEventListener("input",Calculate),document.getElementById("InsertRecordFacility_Improvement").addEventListener("input",Calculate),document.getElementById("InsertRecordSales_Tax").addEventListener("input",Calculate),document.getElementById("InsertRecordCER_Type").addEventListener("change",Calculate),document.getElementsByName("cbParamVirtual13")[0].addEventListener("change",function(){setTimeout(Calculate,2e3)}),document.getElementById("Submit").addEventListener("click",Calculate),document.getElementById("InsertRecordFilter").addEventListener("change",Calculate),document.getElementById("InsertRecordComputer").addEventListener("change",Calculate),document.getElementById("InsertRecordNPV").addEventListener("input",Calculate),document.getElementById("InsertRecordPayback_Period").addEventListener("input",Calculate),document.getElementById("InsertRecordFinancial_Analysis").addEventListener("change",Calculate),document.getElementById("InsertRecordDate").addEventListener("input",Calculate),document.getElementById("InsertRecordContact_Person").addEventListener("input",Calculate),document.getElementById("InsertRecordRequestor_Email").addEventListener("input",Calculate),document.getElementById("InsertRecordPhone").addEventListener("input",Calculate),document.getElementById("InsertRecordAddress").addEventListener("input",Calculate),document.getElementById("InsertRecordRoom_Num").addEventListener("input",Calculate),document.getElementById("InsertRecordComment_Justify").addEventListener("input",Calculate),document.getElementById("InsertRecordVendor").addEventListener("input",Calculate),document.getElementById("InsertRecordDescription").addEventListener("input",Calculate),document.getElementById("InsertRecordMD_Buyilne").addEventListener("change",Calculate);
